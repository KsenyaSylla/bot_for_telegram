# Телеграм-бот для включения/отключения дефектов, а также получения статуса и истории

## Основные команды

- **/start** - запуск бота
- **/stop** - остановка бота
- **/on** - включить дефект
- **/off** - отключить дефект
- **/status** - получение нынешнего статуса дефекта: включен или отключен
- **/history** - получение истории включений/отключений дефектов
- **/defect_info** - получение информации о дефекте по коду или названию
  
Тут нужно обработать фокус с тем, чтобы можно было включать/отключать дефекты как по номеру, так и по названию дефекта. Для этого нужны актуальные данные в паре код-название. Их надо подтягивать из гугл-таблиц. С какой периодичностью? Как можно это автоматизировать? И можно ли вообще...
В каком формате я буду хранить данные в БД, из которой буду подтягивать коды в робота?

Структура БД
код дефекта, название дефекта, статус дефекта (сейчас это on_service), дата последнего обновления статуса, история в формате дописываемой json строки
Все значения - строки, кроме даты.

Сейчас мне надо развернуть докер контейнер, в нем образ базы данных, в которую я всё сложу, написать тесты к запросам в БД и обработки эти запросов.

Собрать данные и настроить обновление словаря дефектов с кодами

запросы к БД

- получить полную историю
- получить статус на данный момент и дату изменения
- включить дефект - читай, изменить одно значени
- отключить дефект - то же самое. Это значение в столбце status

## Работа с докер-контейнером, в котором лежит бд postgesql, через терминал

Команда, которой я разворачивала бд:
*sudo docker run --name defect_status-pg -e POSTGRES_PASSWORD=adventus -p 5432:5432 -d postgres*

Команда на проверку имеющихся работающих контейнеров
*sudo docker ps*
conteiner_id = **< пример номера e1c7953eb64b>**

Команда, которой подключится к докер-контейнеру для раюоты с бд
*sudo docker exec -it defect_status-pg psql -U postgres*
Выведет *psql (17.4 (Debian 17.4-1.pgdg120+2))* и перекинет в оболочку postrges
Подсказки по postgres **\\?** и выйти оттуда - **q**
Выйти из postrgres - **\\q**

Посмотреть порт
*sudo docker port defect_status-pg*
Найти IP адрес, ключ IPAddress
*sudo docker inspect defect_status-pg*
"IPAddress": "172.17.0.2"

Порты:
5432/tcp -> 0.0.0.0:5432
5432/tcp -> [::]:5432
