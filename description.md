# Телеграм-бот для включения/отключения дефектов, а также получения статуса и истории

## Основные команды

- **/start** - запуск бота
- **/stop** - остановка бота
- **/on** - включить дефект
- **/off** - отключить дефект
- **/status** - получение нынешнего статуса дефекта: включен или отключен
- **/history** - получение истории включений/отключений дефектов
- **/defect_info** - получение информации о дефекте по коду или названию
  
Тут нужно обработать фокус с тем, чтобы можно было включать/отключать дефекты как по номеру, так и по названию дефекта. Для этого нужны актуальные данные в паре код-название. Их надо подтягивать из гугл-таблиц. С какой периодичностью? Как можно это автоматизировать? И можно ли вообще...
В каком формате я буду хранить данные в БД, из которой буду подтягивать коды в робота?

Структура БД
код дефекта, название дефекта, статус дефекта (сейчас это on_service), дата последнего обновления статуса, история в формате дописываемой json строки
Все значения - строки, кроме даты.

Сейчас мне надо развернуть докер контейнер, в нем образ базы данных, в которую я всё сложу, написать тесты к запросам в БД и обработки эти запросов.

Собрать данные и настроить обновление словаря дефектов с кодами

запросы к БД

- получить полную историю
- получить статус на данный момент и дату изменения
- включить дефект - читай, изменить одно значени
- отключить дефект - то же самое. Это значение в столбце status

## Запускаем контейнеры

docker-compose up -d

## Проверяем, что файл CSV есть в контейнере

docker exec -it postgres_db ls -l /docker-entrypoint-initdb.d/

## Подключаемся к базе

docker exec -it postgres_db psql -U postgres -d mydatabase

## Импортируем CSV в таблицу

\COPY defects FROM '/docker-entrypoint-initdb.d/data.csv' DELIMITER ',' CSV HEADER;

## Проверяем, что данные добавились

SELECT * FROM defects;
